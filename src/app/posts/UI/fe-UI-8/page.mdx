# æ‰‹æŠŠæ‰‹æ­å»ºåŸºäºReactçš„å‰ç«¯UIåº“ ï¼ˆå…«ï¼‰-- æ¨¡æ€æ¡†
---

## 1. å‰è¨€

æˆ‘ä»¬ç»§ç»­æˆ‘ä»¬çš„ React ç»„ä»¶åº“ç³»åˆ—ã€‚æœ¬ç¯‡ä»‹ç»å¦ä¸€ç§å¼¹å‡ºå±‚ - æ¨¡æ€æ¡†ç»„ä»¶ã€‚æœ¬æ–‡çš„ä»£ç å±•ç¤ºçš„æ˜¯ä¸»è¦çš„æ ¸å¿ƒä»£ç ï¼Œå…¨éƒ¨ä»£ç è§ä»“åº“ï¼š[Giteeä»“åº“](https://link.juejin.cn/?target=https%3A%2F%2Fgitee.com%2Fdh1992%2Fdux-ui-react%2F)ï¼Œç»„ä»¶æ ·å¼è§[ä¸»é¡µ](https://link.juejin.cn?target=https%3A%2F%2Fdh1992.gitee.io%2Fdux-ui-react%2F)ã€‚

æ¨¡æ€æ¡†å’Œä¸Šä¸€æœŸè®²çš„popoverç±»ä¼¼ï¼Œä¹Ÿæ˜¯å¼¹å‡ºå±‚ç»„ä»¶ã€‚ä¸åŒçš„æ˜¯ï¼Œæ¨¡æ€æ¡†ä¸éœ€è¦é€šè¿‡triggerè§¦å‘ï¼Œé€šè¿‡ç›‘å¬ä¼ å…¥çš„ `visible` å‚æ•°å³å¯ç¡®å®šæ˜¾ç¤ºè¿˜æ˜¯éšè—ã€‚

## 2. å®šä¹‰å…¥å‚

ä¸€ä¸ªå¼¹çª—ï¼Œä¸€èˆ¬éœ€è¦ä¸€ä¸ªtitleï¼Œä¸€ä¸ªç»“å°¾çš„æŒ‰é’®æ”¾ç½®åŒºfooterã€‚è¿˜æœ‰å¼¹çª—çš„å°ºå¯¸sizeï¼ŒèƒŒæ™¯åŒºåŸŸçš„é®ç½©maskï¼Œæœ€åè¿˜æœ‰æ˜¾ç¤ºå‚æ•°visibleä»¥åŠå¼¹çª—çš„å„ç§äº‹ä»¶ï¼š

| å±æ€§              | è¯´æ˜         |
| --------------- | ---------- |
| visible         | å—æ§ï¼Œæ§åˆ¶å¼¹å‡ºå±‚å±•ç¤º |
| title       | æ ‡é¢˜       |
| footer | è„šæ³¨       |
| size           | æšä¸¾å‡ºå†…ç½®çš„å°ºå¯¸     |
| mask          | æ˜¯å¦æ˜¾ç¤ºé®ç½©         |
| visible  | æ§åˆ¶æ˜¾ç¤º      |
| onClose | ç‚¹å‡»å…³é—­æŒ‰é’®çš„ç›¸åº”äº‹ä»¶ |
| onOk | ç‚¹å‡»ç¡®å®šæŒ‰é’®çš„ç›¸åº”äº‹ä»¶ |
| afterClose | å…³é—­ä¹‹åçš„äº‹ä»¶å›è°ƒ |

## 3. rc-dialog å°è£…

è¿™å¯¹å®šåˆ¶åŒ–å¼¹çª—ç»„ä»¶ï¼Œä½¿ç”¨rc-triggerä¼¼ä¹æœ‰äº›åŠ›ä¸ä»å¿ƒï¼Œrc-triggeré‡ç‚¹åœ¨äºå¤„ç†è§¦å‘çš„æ—¶æœºï¼Œå¼¹å‡ºå±‚è·Ÿéšç‚¹å‡»ä½ç½®ï¼Œé€‚åˆè½»é‡çº§çš„å¼¹å‡ºå±‚ï¼›æ¨¡æ€æ¡†é‡ç‚¹åœ¨äºå¤„ç†å†…å®¹å±•ç¤ºï¼Œéœ€è¦æ›´å¥½çš„å±•ç¤ºçº§çš„åº“æ¥æ”¯æŒã€‚

è¿™é‡Œä½¿ç”¨ä¸“ç”¨çš„rc-dialogï¼š

```jsx
class RcDialogWrap extends Component {
  static propTypes = {
    className: PropTypes.string,
    wrapClassName: PropTypes.string,
  };
  render() {
    const { className, wrapClassName, ...rest } = this.props as any;
    return (
      <RcDialog
        wrapClassName={classnames(className, wrapClassName)}
        {...rest}
      />
    );
  }
}
```
`className` ä¸ºå¼¹çª—å†…å®¹æ ·å¼ç±»åï¼Œ`wrapClassName` ä¸ºå¼¹çª—å®¹å™¨æ ·å¼ç±»åã€‚

æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å¼¹çª—ï¼Œè‚¯å®šéœ€è¦æ¯”rc-dialogæ›´å¤šçš„å‚æ•°å’ŒåŠŸèƒ½ï¼Œå› æ­¤æˆ‘å†ä½¿ç”¨ModalWrapåŒ…è£¹ä¸€ä¸‹åˆšåˆšçš„ç»„ä»¶ï¼š


```js
export const ModalWrap = styleWrap()(
  styled(RcDialogWrap)((props) => {
    const {
      theme: { designTokens: DT, fontSize },
      mask,
      customStyle,
    } = props as any;
    
    return css`
    
      // å¼¹çª—å®¹å™¨
      position: fixed;
      overflow: auto;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      z-index: 1010;
      -webkit-overflow-scrolling: touch;
      outline: 0;
    
      ...
    `
  })
);
```

å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªå¼¹çª—ä½¿ç”¨fixedå®šä½ï¼Œå¹¶ä¸”å±…ä¸­æ”¾ç½®ï¼Œz-indexè®¾ç½®æ¯”è¾ƒå¤§ï¼Œç¡®ä¿åœ¨æœ€é¡¶å±‚å³å¯ã€‚

æˆ‘ä»¬å†æ¥çœ‹çœ‹ ModalWrapæ˜¯æ€ä¹ˆä½¿ç”¨çš„ï¼š


```jsx
...
<ModalWrap
  // é»˜è®¤çš„ä¸€äº›ç›´ä¼ å±æ€§ï¼Œæ¯”å¦‚ visible ç­‰
  {...rest}
  style={{
    // æ¥å—è‡ªå®šä¹‰çš„widthæ ·å¼
    width: width,
    ...style,
  }}
  // prefixClsä¸ºç»„ä»¶åº“å‰ç¼€ï¼Œè¿™é‡Œä¸º dux-ui-modal
  prefixCls={prefixCls}
  // è¿™é‡Œç¦ç”¨rc-dialogè‡ªå¸¦çš„å…³é—­æŒ‰é’®
  closable={false}
  // ä¼ é€’rc-dialogå¯è¯†åˆ«çš„åŠ¨ç”»
  animation="slide-fade"
  maskAnimation="fade"
  onClose={onClose}
  title={[
    <div key="content" className={`${prefixCls}-title-content`}>
      {title}
    </div>,

    closable && (
      <Icon
        key="close"
        type="remove_circle"
        className={`${prefixCls}-close`}
        onClick={onClose}
      />
    ),
  ]}
  // ä½¿ç”¨äº†lodashï¼š_
  footer={_.isFunction(footer) ? footer({ locale }) : footer}
>
  // è·å–ref
  <div ref={this.savePopupContainer}></div>
  // å†…å®¹ç‰©
  {children}
</ModalWrap>
```

æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç ã€‚

- animation å’Œ maskAnimation ä¸ºç›´ä¼ ç»™ rc-dialog çš„åŠ¨ç”»é…ç½®é¡¹ï¼›
- onClose æ˜¯å…³é—­äº‹ä»¶ï¼Œç”±propsä¼ å…¥
- title å°è£…äº†ä¼ å…¥çš„ title å…ƒç´ å’Œ å…³é—­æŒ‰é’®Iconï¼Œå¹¶ä»˜ç»™å…³é—­äº‹ä»¶onClose
- footer ä¹Ÿæ˜¯ç›´ä¼ å‚æ•°ã€‚å¯è‡ªå®šä¹‰ï¼ŒåŒæ—¶ä¹Ÿå†…ç½®äº†ä¸€ç»„æ“ä½œè„šæ³¨ï¼š

```js
getDefaultFooter = () => {
    const { onOk, onClose, locale } = this.props as any;
    return [
      <Button size="lg" key="cancel" onClick={onClose} style={{ marginRight: 8 }}>
        {locale.cancel}
      </Button>,
      <Button size="lg" key="confirm" onClick={onOk} styleType="primary">
        {locale.confirm}
      </Button>,
    ];
};
```

å¤–å£³å’Œäº‹ä»¶å¤„ç†çœ‹å®Œäº†ï¼Œå†çœ‹çœ‹å†…å®¹ç‰© children æ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚æˆ‘ä»¬ä¸ºäº†ä½¿ç”¨ä¾¿åˆ©ï¼Œå¯¹ç”¨æˆ·æš´éœ²å‡ºä¸€ä¸ªå†…ç½®çš„modal content ç»„ä»¶ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªåŠ äº†æ ·å¼çš„ divï¼š


```jsx
export const SContent = styleWrap({ className: contentCls })(
  styled.div((props) => {
    const { maxHeight } = props as any;
    return css`
      padding: 16px 20px;
      overflow: auto;
      max-height: ${maxHeight};
    `;
  }),
);
```

## 4. ä¸€ä¸ªğŸŒ°

æˆ‘ä»¬æ¥ä½¿ç”¨ä»¥ä¸‹åˆšåˆšå†™å¥½çš„ç»„ä»¶ï¼š


```jsx
...
const props = {
    visible: true
}
<Modal
    {...props}
    onClose={() => this.close()}
    afterClose={() => console.log('afterClose')}
    onOk={() => console.log('onOk')}
    title="this is title"
>
    <Modal.Content>this is content</Modal.Content>
</Modal>
```

ç•Œé¢å¦‚ä¸‹ï¼š


![image.png](/images/2022-6-28/2022-6-28-1.png)

<hr />

æ¨¡æ€æ¡†ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œæœ¬æ–‡å°±åˆ°æ­¤ç»“æŸå•¦~~

